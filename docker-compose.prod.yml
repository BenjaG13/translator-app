version: '3.8'

services:
  laravel:
    image: dockertranslatorapp-dgdzfka9fscxg2ht.azurecr.io/laravel:latest
    environment:
      DB_CONNECTION: postgres
      DB_HOST: ep-green-lab-a8d61zj7-pooler.eastus2.azure.neon.tech
      DB_PORT: 3306
      DB_DATABASE: db_translator
      DB_USERNAME: db_translator_admin
      DB_PASSWORD: npg_AYNfHjz8yw6S
    ports:
      - "9000:9000"
    depends_on:
      - libretranslate

  frontend:
    image: dockertranslatorapp-dgdzfka9fscxg2ht.azurecr.io/frontend:latest
    environment:
      - CHOKIDAR_USEPOLLING=true
    ports:
      - "3000:3000"
    depends_on:
      - laravel

  caddy:
    image: dockertranslatorapp-dgdzfka9fscxg2ht.azurecr.io/caddy:latest
    ports:
      - "80:80"
    depends_on:
      - frontend
      - laravel

  libretranslate:
    image: dockertranslatorapp-dgdzfka9fscxg2ht.azurecr.io/libretranslate:latest
    ports:
      - "5000:5000"
    command: --load-only=en,es